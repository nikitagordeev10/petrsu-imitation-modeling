// ================================= Функции для решения задачи =================================

Функция СгенерироватьСлучайноеЧислоНеймана(Минимум, Максимум)
	// Метод Неймана для генерации случайного числа
    Пока Истина Цикл
        // Генерация случайного дробного числа в диапазоне [0, 1)
        СлучайноеДробное = Математика.СлучайноеЧислоОт0До1();

        // Масштабируем число в диапазон [Минимум, Максимум]
        x = Минимум + (Максимум - Минимум) * СлучайноеДробное;

        // Генерация случайного числа y для проверки
        y = Математика.СлучайноеЧислоОт0До1();

        // Проверка условия y <= f(x)
        // В данном случае f(x) = 1 (равномерное распределение)
        Если y <= 1 Тогда
            Возврат x; // Возвращаем x как случайное число
        КонецЕсли;
	КонецЦикла;
КонецФункции

// ================================= Команды формы =================================

&НаКлиенте
Процедура СгенерироватьТочки(Команда)
    // Указываем путь к файлу
    ИмяФайла = "D:\petrsu\imitation_modeling\lib\helix_points.txt"; // Укажите путь к файлу
	
    num_points  = 400; // Количество точек
    pi = 3.141592653589793; // Значение числа π

    // Создаем объект для записи текста в файл
    ЗаписьТекста = Новый ЗаписьТекста(ИмяФайла, КодировкаТекста.UTF8, Символы.ПС, Ложь);

    Объект.Выборка.Очистить();
	
    Для i = 0 По num_points - 1 Цикл
        // Генерация случайных значений u и v методом Неймана
        u = СгенерироватьСлучайноеЧислоНеймана(0, 2 * pi);
        v = СгенерироватьСлучайноеЧислоНеймана(0, 2 * pi);

        // Вычисление координат
        x = u * Cos(v); // Вычисление x
        y = u * Sin(v); // Вычисление y
        z = v;          // Вычисление z

		// Форматируем каждую координату в строку с фиксированным количеством знаков после запятой
		СтрокаX = СтрЗаменить(Формат(x, "ЧГ=6"), ",", ".");
		СтрокаY = СтрЗаменить(Формат(y, "ЧГ=6"), ",", ".");
		СтрокаZ = СтрЗаменить(Формат(z, "ЧГ=6"), ",", ".");

		// Если значение нулевое, явно задаем "0.000000"
		Если x = 0 Тогда
		    СтрокаX = "0.000000";
		КонецЕсли;
		Если y = 0 Тогда
		    СтрокаY = "0.000000";
		КонецЕсли;
		Если z = 0 Тогда
		    СтрокаZ = "0.000000";
		КонецЕсли;
		
        НоваяСтрока = Объект.Выборка.Добавить();
        НоваяСтрока.X = СтрокаX;
        НоваяСтрока.Y = СтрокаY;
        НоваяСтрока.Z = СтрокаZ;

        // Формируем строку для записи в файл
        СтрокаВывода = СтрокаX + " " + СтрокаY + " " + СтрокаZ;
        
        // Записываем строку в файл
        ЗаписьТекста.ЗаписатьСтроку(СтрокаВывода);
	КонецЦикла;
	
    // Закрываем файл
    ЗаписьТекста.Закрыть();
    Сообщить("Данные успешно выгружены в файл: " + ИмяФайла);
КонецПроцедуры
